<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="css/rotation.css">
</head>

<body>
    <button onclick="startGame()" id="startButton">Restart</button>
    <input type="text" ; id="scoore" ; value=>
    <canvas id="cvs" width="2000" height="850" style="border:5px solid black;"></canvas>
</body>
        
<script>
    let canvas = document.getElementById("cvs"), ctx = canvas.getContext("2d");
    ctx.fillStyle = "blue";
    //ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    /* cloud 3shirheg */
    let cloud = new Image; cloud.src = 'P_cloud.png';

    /* shalbaag */
    let dirt = new Image; dirt.src = 'P_shavar.png';

    /* background ub zurag */
    let img1 = new Image;

    /* land, zvleg 4shirheg */
    let img2 = new Image, img21 = new Image, img22 = new Image, img23 = new Image,
    imgPe1 = new Image, imgCar = new Image, imgDog = new Image, imgStatu = new Image,
    imgShavar = new Image, imgNuh = new Image, imgBaishin = new Image, imgBaishin2 = new Image,
    imgLamp = new Image, imgGandan = new Image; 

    let clouds = [{x: 500, y: 50, w: 400, h: 200},{x: 1000, y: 50, w: 300, h: 150}, {x: 1500, y: 50, w: 400, h: 200}];
    let dirts = [{x: 1800, y: 700, w: 80, h: 80}];

    function init() {
        /* land, zvlegnii bairshlin hemjee */
        x2 = 2000;
        y2 = 700;
        x21 = 1000;
        y21 = 700;
        x22 = 0;
        y22 = 700;
        x23 = -1000;
        y23 = 700;
        Xpe = 100;
        Ype = 350;

        /* baishin2 bairlal */
        xbaishin2 = 900;
        ybaishin2 = 260;

        /* car bairshil */
        Xcar = 1500;
        Ycar = 600;

        /* dog bairshil */ 
        Xdog = 1500;
        Ydog = 630;

        /* boy iin bairlal */
        Xpe = 500;
        Ype = 520;

        /* hushuu bairlal */
        xstatu = 1200;
        ystatu = 300;
        
        /* baishin bairlal  */
        xbaishin = 550;
        ybaishin = 450;

        /* lamp bairlal */
        xlamp = 480;
        ylamp = 550;

        /* buh oruulsan zurgin holboos */
        
        img2.src = 'P_land.png';
        img21.src = 'P_land.png';
        img22.src = 'P_land.png';
        img23.src = 'P_land.png';
        imgPe1.src = 'P_boy.png';
        imgCar.src = 'P_car.png'; 
        imgDog.src = 'P_dog.png';
        imgStatu.src = 'P_Statu.png';

        
        /* land, zvlegnii hemjee */
        img2.height = 150;
        img2.width = 1100;
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        /* boy girl hemjee */
        imgPe1.width = 150;
        imgPe1.height = 250;
        
        /* car hemjee */
        imgCar.width = 400;
        imgCar.height = 150;

        /* dog hemjee */ 
        imgDog.width = 170;
        imgDog.height = 120;

        /* hushuu hemjee */ 
        imgStatu.height = 400;
        imgStatu.width = 300;

        /* baishin hemjee */
        imgBaishin.height = 250;
        imgBaishin.width = 300;

        /* baishin2 hemjee */
        imgBaishin2.width = 300;
        imgBaishin2.height = 450;

        /* Lamp hemjee */
        imgLamp.width = 50;
        imgLamp.height = 150;
    }

    init();


    function drawClouds(){
        if (clouds.length != 0 && clouds[0].x < 0){
            clouds.shift();
        }

        clouds.forEach(element => {
            if (!(element.x + element.w < 0 && element.x > canvas.width)){
                ctx.drawImage(cloud, element.x, element.y, element.w, element.h);
            }
        });

        if (clouds.length < 3){
            let xPos = 1800 + Math.floor(Math.random() * 100);
            let yPos = Math.floor(Math.random() * 50);
            let w = Math.floor(300 + Math.random() * 100);
            let h = Math.floor(100 + Math.random() * 100);
            clouds.push({x: xPos, y: yPos, w: w, h: h})
        }
    }

    function drawDirts(){
        if (dirts.length != 0 && dirts[0].x < 0){
            dirts.shift();
        }   

        dirts.forEach(element => {
            if (!(element.x + element.w < 0 && element.x > canvas.width)){
                ctx.drawImage(dirt, element.x, element.y, element.w, element.h);
            }
        });

        if (dirts.length < 1){
            let xPos = 1800 + Math.floor(Math.random() * 100);
            let yPos = 700 + Math.floor(Math.random() * 50);
            let w = Math.floor(50 + Math.random() * 40);
            let h = Math.floor(50 + Math.random() * 20);
            dirts.push({x: xPos, y: yPos, w: w, h: h})
        }
    }
    
    setInterval(() => {

        // cloud movements
        clouds.forEach(element => {
            element.x -= 1;
        });

        dirts.forEach(element => {
            element.x -= 1;
        });


        x2--;
        x21--;
        x22--;
        x23--;
        Xcar = Xcar - 1;
        Xdog = Xdog - 5; 

        ctx.clearRect(0, 0, canvas.width, canvas.height);
        

        /* land zulegni orulsan hseg */
        ctx.drawImage(img2, x2, y2, img2.width, img2.height);
        ctx.drawImage(img21, x21, y21, img2.width, img2.height);
        ctx.drawImage(img22, x22, y22, img2.width, img2.height);
        ctx.drawImage(img23, x23, y23, img2.width, img2.height);

        /* baishin2 oruulsan hseg */
        ctx.drawImage(imgBaishin2, xbaishin2, ybaishin2, imgBaishin2.width, imgBaishin2.height);

        /* baishin oruulsan heseg */
        ctx.drawImage(imgBaishin, xbaishin, ybaishin, imgBaishin.width, imgBaishin.height)

        /* cloud orulsan hseg */
        // console.log(x, y, img.width / 2, img.height / 2);
        // console.log(clouds[0].x, clouds[0].y, clouds[0].width, clouds[0].height);

        drawClouds();

        /* DIRT */

        drawDirts();

        /* lamp oruulsan heseg */
        ctx.drawImage(imgLamp, xlamp, ylamp, imgLamp.width, imgLamp.height);

        /* hushuu oruulssan heseg*/
        ctx.drawImage(imgStatu, xstatu, ystatu, imgStatu.width, imgStatu.height);

        /* car orulsan hseg */
        ctx.drawImage(imgCar, Xcar, Ycar, imgCar.width, imgCar.height);

        /* dog orulsan hseg */ 
        ctx.drawImage(imgDog, Xdog, Ydog, imgDog.width, imgDog.height);

        /* boy girl oruulsan ni */
        ctx.drawImage(imgPe1, Xpe, Ype, imgPe1.width, imgPe1.height);

        
    }, 1);

    
    
</script>
</html>